(()=>{var e={2392:(e,t,n)=>{"use strict";var r=n(4433),i=n(1762),o="is-empty",a="is-loaded",s="not-filled",u="fixed_bottom",c="adhesion";function d(e,t,n,r){function d(){return t===e.pageId}function l(o,a,s){if(e.forceAllSlotsEmpty)return p("all slots on page",t,"forced empty by configuration"),function(t){var n=t.map((function(t){var n=e.document.getElementById(t.id);return n?Promise.resolve({slotId:t.id,element:n,filled:!1,sizeCode:null}).then((function(e){return f(e),e})):Promise.reject(new Error("missing container element for ad "+t.id))}));return Promise.all(n)}(o);var l=window.GdprStatus,m=[P,e.clientPageModelPromise,e.breakpointPromise,l.isApplicable(),l.countryCodeSafe(),r];return Promise.all(m).then((function(r){if(!d())return p("ignoring prereqs for defunct page",t),void Promise.reject("Page not current");var l=r[0],m=r[1],g=r[2],h=r[3];p("requesting for page",t,"slots with screenSize",g);var w=i.makePageModel(n.global.baseModel,a&&a.keyValues||{},h,m),P=o.filter((function(e){return!e.screenSizes||-1!==e.screenSizes.indexOf(g)}));e.hasAdhesionAndFixedBottomZone&&(P=function(t,n){if(b){var r=t.filter((function(e){var t=e.model.zone;return t!==c&&t!==u||(b[t]=e,n&&(y[t]=n.getMaxBidForAdUnit(e.id)),!1)}));if(u in b&&c in b){var i=function(){S++;var e=v.config.global.config.expectedRefreshCount;return null==e&&(e=6),u in y?0===y.fixed_bottom?u:u in y&&c in y?y.adhesion<=y.fixed_bottom*Math.max(e-(S-1),1)?u:c:u:c}();if(r.push(b[i]),delete b[i],i===c){if(A=!0,window.dispatchEvent(new window.CustomEvent("phoenix:advertising:adhesionWon")),b.fixed_bottom){var o=e.document.getElementById(b.fixed_bottom.id);if(o){var a=o.closest("phoenix-ad");a&&a.parentElement.removeChild(a)}}b=void 0}}return r}return A&&(t=t.filter((function(e){return e.model.zone!==u}))),t}(P,s)),(P=P.map((function(t){var r={};s&&(r=s.getSlotModelPropertiesForAdUnit(t.id));var i,o,a,u=e.document.getElementById(t.id);return u?{id:t.id,adUnitPath:t.adUnitPath,config:t.config,element:u,model:Object.assign({},t.model,(i=n.global.baseModel,o=t.model,a=Math.min(o.index,4),{zoneIndex:o.zone+"_"+a,siteZoneIndex:i.hostname+"_"+o.zone+"_"+a}),r)}:(console.warn("missing container element for ad",t.id),null)})).filter((function(e){return!!e}))).forEach((function(t){var n;if(!t.model.isOutstream){var r=t.element.parentElement;if(r){var i='[data-ad-group="'+r.parentElement.getAttribute("data-ad-group")+'"]',o=e.document.querySelectorAll(i+".not-size-"+g),a={D:!0};for(n=0;n<o.length;n++){var s=o[n];["A","B","C"].forEach((function(e){s.classList.contains("not-size-"+e)||(a[e]=!0)})),s.parentElement.removeChild(s)}var u=e.document.querySelectorAll(i);for(n=0;n<u.length;n++)Object.keys(a).forEach((function(e){var t="not-size-"+e;u[n].classList.remove(t),r.classList.remove(t)}))}}}));var x=new Promise((function(e){if("visible"!==document.visibilityState){var t=function(){"visible"===document.visibilityState&&(document.removeEventListener("visibilitychange",t),e(!0))};document.addEventListener("visibilitychange",t,!1)}else e(!0)}));return x.then((function(){return p("adServer.requestAds",P),l.requestAds(n.global.config,w,P,s,x).then((function(e){return e.map((function(e){return e.then((function(e){return e&&f(e),e}))}))})).then((function(e){return Promise.all(e)}))}))}))}function f(e){var t=e.element,n=e.filled,r=e.sizeCode,i=e.sizeDims,u=t.parentElement,c=u.parentElement;if(u.classList.remove("is-placeholder"),!n)return c.classList.add(o),u.classList.add(o),c.classList.add(s),u.classList.add(s),c.classList.remove(a),u.classList.remove(a),void m(e);c.classList.add(a),u.classList.add(a),c.classList.remove(o),u.classList.remove(o),t.setAttribute("data-ad-size",r);var d=c.getAttribute("data-class-rules");if(d){var l,f,g=JSON.parse(d);for(l=0;l<g.length;l++){var v=g[l];if(v.sizes&&-1!==v.sizes.indexOf(r)||v.sizes&&-1!==v.sizes.indexOf(i)||v.dimensions&&-1!==v.dimensions.indexOf(i))for(f=0;f<v.classes.length;f++)c.classList.add(v.classes[f]);else for(f=0;f<v.classes.length;f++)-1!==c.classList.contains(v.classes[f])&&c.classList.remove(v.classes[f])}}m(e)}function m(e){e.slotId&&(g(e.slotId),w[e.slotId]&&w[e.slotId].resolve(e))}function g(e){return h[e]||(h[e]=new Promise((function(t,n){w[e]={resolve:t,reject:n}})).then((function(t){return delete w[e],t}),(function(t){throw delete w[e],t}))),h[e]}var v=this;v.pageId=t,v.config=n;var p=e.debugLog,h={},w={};p("adServer.initPage");var P=e.adServerPromise.then((function(e){if(d())return e.initPage().then((function(){return p("adServer.initPage completed"),e}));throw new Error("Page not current")}));v.makeInitialAdCall=function(){var t;return e.adAuctionPromise.then((function(e){return t=e,e.getLatestResult()})).then((function(r){var i=[];return n.sizedSlots.forEach((function(t){e.resetAdSlot(t.id),t.model.deferLoad||i.push(t)})),n.outOfPageSlots&&n.outOfPageSlots.forEach((function(t){e.resetAdSlot(t.id),i.push(t)})),l(i,t,r)}))},v.makeOutOfPageAdCall=function(){var t;return e.adAuctionPromise.then((function(e){return t=e,e.getLatestResult()})).then((function(e){return l(n.outOfPageSlots||[],t,e)}))},v.makeDynamicAdCall=function(t,n){var r;return e.adAuctionPromise.then((function(e){return r=e,n.auctionId?e.getResultById(n.auctionId):e.getLatestResult()})).then((function(e){return l(n.slots,r,e)}))},v.getSlotResult=function(e){return g(e)},v.close=function(){p("close page",t),Object.keys(w).map((function(e){w[e].reject(new Error("cancelled by navigation"))}))};var b={},y={},A=!1,S=0}e.exports=function(e){e=e||{},this.adServerPromise=e.adServerPromise,this.breakpointPromise=e.breakpointPromise,this.clientPageModelPromise=e.clientPageModelPromise,this.document=e.document,this.adAuctionPromise=e.adAuctionPromise,this.timedOutPageLoadPromise=e.timedOutPageLoadPromise,this.forceAllSlotsEmpty=!!e.forceAllSlotsEmpty,this.debugLog=e.debugLog||function(){};var t=this.debugLog;t("new Session with options",e);var n=this;n.pageId=0,n.dynamicCallId=0;var i,o,a=new Promise((function(e){i=e}));n.beginPage=function(e){function a(t){return e.sizedSlots.some((function(e){return e.model.zone===t}))}var s=++n.pageId,u=r("advertising:beginPage:"+s);return o&&o.close(),n.hasAdhesionAndFixedBottomZone=a("adhesion")&&a("fixed_bottom"),t("begin page",s,e),o=new d(n,s,e,n.timedOutPageLoadPromise),1==s&&i(),t("page",s,"initial ad call"),o.makeInitialAdCall().then((function(e){return t("page",s,"initial ad call result:",e),u.end(),e}),(function(e){return t("page",s,"initial ad call failed:",e),u.end(),Promise.reject(e)}))},n.getPage=function(){return a.then((function(){return o}))},n.getAdCallConfig=function(e,t){return Promise.all([n.adServerPromise,a]).then((function(n){var r=n[0],i=o.config.global.config;return r.getAdCallConfig(e,t,i)}))},n.resetAdSlot=function(e){n.adServerPromise.then((function(t){t.resetAdSlot(e)}))},n.dynamicCall=function(e){var i=++n.dynamicCallId;t("dynamic call",i,e);var s=r("advertising:dynamicCall:"+i);return a.then((function(){return o.makeDynamicAdCall(i,e).then((function(e){return t("dynamic call",i,"result:",e),s.end(),e}))})).catch((function(e){return t("dynamic call",i,"failed:",e),s.end(),Promise.reject(e)}))},n.getSlotResult=function(e){if(!o)throw new Error("cannot call getSlotResult before a page is active");return o.getSlotResult(e)},n.reloadAd=function(e,t){return n.getSlotResult(e.id).then((function(){return n.resetAdSlot(e.id),n.dynamicCall({slots:[e],auctionId:t})})).catch((function(t){console.warn(t),n.dynamicCall({slots:[e]})}))}}},6463:(e,t,n)=>{"use strict";var r=n(2004);e.exports=Promise.resolve({referrer:function(){var e;try{window.top.document.referrer&&(e=window.top.document.referrer)}catch(t){e=document.referrer}return e?r(e):void 0}()})},1762:(e,t,n)=>{"use strict";var r=n(2004);function i(e,t){switch(e.type){case"simple":return t[e.key]}}function o(){var e;try{window.top.document.referrer&&(e=window.top.document.referrer)}catch(t){e=document.referrer}return e?r(e):void 0}e.exports={evalTemplate:i,makePageTargeting:function(e,t,n,r){var o=n.beacons&&n.beacons.targetingParams&&n.beacons.targetingParams.exclude||{},a={};return Object.keys(e||{}).forEach((function(n){var s=i(e[n],t);"number"==typeof s&&(s+=""),null==s||""===s||Array.isArray(s)&&0===s.length||(r&&r.setTargeting(n,s),!o[n]&&(a[n]=s))})),a},vastCustomParams:function(e,t,n){var r=["ag","channel","cs","direct","et","feats","gd","in","lang","loggedin","pagetype","path","pod","pt","referrer","terms"];for(var i in t||(t={}),t)if(-1<r.indexOf(i)){var o=t[i];Array.isArray(o)&&(o=o.join(",")),e[i]=o}return n?encodeURIComponent(Object.keys(e).map((function(t){return[t,e[t]].join("=")})).join("&")):e},makePageModel:function(e,t,n,r){var i={};window.phxTrackedFeatures&&(i={trackedFeatures:Object.keys(window.phxTrackedFeatures).map((function(e){return e+":"+(window.phxTrackedFeatures[e]?"1":"0")})).join("|")});var a={};if(n){var s=window.GdprStatus;a={donottrack:!0,gdprIsApplicable:!0,gdprIsConsentGivenPromise:s.waitForConsentValue().then((function(){return s.isConsentGivenForPurposes(s.PURPOSE_IDS.advertising)})),kuid:void 0,optout:!0}}return Object.assign({},e,i,{referrer:o(),loggedIn:window.phxIsLoggedIn()?"1":"0"},a,r||{},t)}}},7796:e=>{"use strict";e.exports=function(e,t){function n(e){t.then?t.then((function(n){t=n,e.call(t)})):e.call(t)}var r=window[e];if(window[e]={push:n},void 0!==r)for(var i=0;i<r.length;i++)n(r[i])}},7965:e=>{"use strict";e.exports=function(e){var t,n=(t=e,window[t]=window[t]||[],window[t]);return new Promise((function(e){n.push((function(){e(this)}))}))}},6483:e=>{"use strict";var t,n=function(){};try{t=window}catch(e){t={}}e.exports=t.performance&&t.performance.mark?t.performance:{getEntriesByName:n,mark:n,measure:n}},4433:(e,t,n)=>{"use strict";var r=n(6483),i=0;function o(){var e="phxMark:"+i++;return r.mark(e),e}e.exports=function(e){var t=o();return{end:function(){var n=o();r.measure(e,t,n);var i=r.getEntriesByName(e);if(i&&i.length)return i[i.length-1].duration}}}},2004:(e,t)=>{var n;void 0===(n=function(){"use strict";return function(e){return e.replace(/^https?:\/\//,"").replace(/[:\/].*/,"").toLowerCase().replace(/^www\./,"").replace(/^m\./,"").replace(/\.blogspot(\.com?)?\.[a-z]{2,3}$/,".blogspot.com").replace(/^.*\.(gamepedia|wikia)(\.com?)?\.[a-z]{2,3}$/,"$1.com").split(".").slice(-3).join(".")}}.apply(t,[]))||(e.exports=n)}},t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(()=>{"use strict";var e=n(7796),t=n(7965),r=n(2392);window.phxConfigQueue.push((function(){var i=window.GdprStatus,o=this.user.hasPremium(),a=this.features.isEnabled("use-mavenuid-demonitized"),s=window.document.location.hash&&-1!==window.document.location.hash.indexOf("phxAdvertisingDebug")?function(){var e=Array.prototype.slice.apply(arguments);e.unshift("%c[phxAdvertisingDebug]%c","font-weight:bold","font-weight:normal"),console.log.apply(console,e)}:void 0;i.isDemonetizedSafe().then((function(i){var u=!!a&&i;s&&(u||o)&&s(o?"ADS402 Premium":"ADS401 Demonetized"),e("phxAdvertisingQueue",new r({adServerPromise:t("phxAdServerQueue"),breakpointPromise:t("phxConfigQueue").then((function(e){return e.breakpoint.get()})),clientPageModelPromise:n(6463),debugLog:s,document:window.document,forceAllSlotsEmpty:o||u,adAuctionPromise:t("phxAdAuctionQueue"),timedOutPageLoadPromise:window.getTimedOutPageLoadPromise(3e4)}))}))}))})()})();
//# sourceMappingURL=advertising.min.js.map