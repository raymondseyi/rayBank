(()=>{"use strict";var e={7965:e=>{e.exports=function(e){var t,i=(t=e,window[t]=window[t]||[],window[t]);return new Promise((function(e){i.push((function(){e(this)}))}))}},2784:e=>{e.exports={getDependencyClass:function(e){if(!e)throw new Error("dependencyName required");return window.customElements.whenDefined(e).then((function(){return window.customElements.get(e)}))},getFirstDependencyElement:function(e,t){if(!e)throw new Error("dependencyName required");return t||(t=document),window.customElements.whenDefined(e).then((function(){var i=t.querySelector(e);if(!i)throw new Error(e+" element cannot be found");return i}))}}}},t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={exports:{}};return e[n](s,s.exports,i),s.exports}(()=>{function e(e,t){var i,n=this,s=null,o=+t;this.delay=t,this.remaining=function(){return Math.max(o+i-+new Date,0)},this.cancel=function(){clearTimeout(s),n.cancelled=!0},this.pause=function(){clearTimeout(s),o-=+new Date-i,n.paused=!0},this.resume=function(){i=+new Date,clearTimeout(s),s=setTimeout(e,o),n.paused=!1},this.resume()}function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?s(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=Array(t);i<t;i++)n[i]=e[i];return n}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var i,n=0;n<t.length;n++)(i=t[n]).enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}function r(e,t,i){return(r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(n){var s=Object.getOwnPropertyDescriptor(n,t);return s.get?s.get.call(i):s.value}})(e,t,i||e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function d(e,i){return!i||"object"!==t(i)&&"function"!=typeof i?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):i}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=i(2784).getDependencyClass,u=i(7965),f=["301x50","321x50","729x90","971x90","300x251","300x601","160x601"],p=["appnexus","ix","rubicon"],m="defer-until-event";c("phoenix-page").then((function(t){var i=function(i){function s(){return o(this,s),w.apply(this,arguments)}!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(s,i);var c,v,g,b,y,w=(b=s,y=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(b);if(y){var i=h(this).constructor;e=Reflect.construct(t,arguments,i)}else e=t.apply(this,arguments);return d(this,e)});return c=s,g=[{key:"observedAttributes",get:function(){return["auto-reload-paused"]}}],(v=[{key:"observedBroadcastedEvents",get:function(){var e=this.getAttribute(m)?this.getAttribute(m).split(" "):[];return[].concat(n(e),["phoenix:fixedBottomAd:hide","phoenix:fixedBottomAd:show"])}},{key:"broadcastedEventCallback",value:function(e){e&&this.deferUntilEvent&&-1<this.deferUntilEvent.indexOf(e)?(this._load(),this.deferUntilEvent=!1):"phoenix:fixedBottomAd:hide"===e?this.fixedVisible&&this.firstChild&&(this.firstChild.classList.add("is-offscreen-bottom"),this.inView=!1,this.isPaused=!0):"phoenix:fixedBottomAd:show"===e&&this.fixedVisible&&this.firstChild&&(this.firstChild.classList.remove("is-offscreen-bottom"),this.inView=!0,this.isPaused=!1)}},{key:"isHidden",get:function(){return!this.fixedVisible&&!this.offsetParent}},{key:"isPaused",get:function(){return this.hasAttribute("auto-reload-paused")},set:function(e){e?this.setAttribute("auto-reload-paused",e):this.removeAttribute("auto-reload-paused")}},{key:"reloadCount",get:function(){return this._reloadCount}},{key:"connectedCallback",value:function(){var e=this;r(h(s.prototype),"connectedCallback",this).call(this),this.autoReload=this.hasAttribute("auto-reload"),this.closeButton=this.hasAttribute("close-button"),this.deferUntilEvent=!!this.getAttr(m)&&this.getAttr(m).split(" "),this.fixedVisible=this.hasAttribute("fixed-visible"),this.skipDynamicCall=this.hasAttribute("skip-dynamic-call"),this.scrollToRefreshThreshold=this.getAttr("scroll-to-refresh"),this.skipScrollToRefresh=!1,this.trackVisibility=this.hasAttribute("track-visibility"),this.initialIndex=this.getAttr("initial-index"),this.isFilled=!1;var i=parseInt(this.getAttr("container-height"));i&&Number.isInteger(i)&&0<i&&(this.containerHeight=i);var n=parseInt(this.getAttr("container-width"));if(n&&Number.isInteger(n)&&0<n&&(this.containerWidth=n),this.containerClass=this.getAttr("container-class"),!this.hasAttribute("config"))throw new Error("No ad configuration was specified.");var o=this;window.phxConfigQueue||(window.phxConfigQueue=[]),window.phxConfigQueue.push((function(){o.breakpoint=this.breakpoint.get()})),this.handleAd=this._handleAd.bind(this),this.adLoadedTime=0,this._reloadCount=0,this.adAuctionPromise=u("phxAdAuctionQueue"),window.phxAdvertisingQueue=window.phxAdvertisingQueue||[],this._initListeners(),this.config.slotId&&!this.hasChildNodes()&&this._addSlotDiv(this.config.slotId),this.initialIndex&&this.config.slotConfig&&this.config.slotConfig.model&&(this.config.slotConfig.model.index=this.initialIndex),t.util.whenPageLoaded().then((function(){if(!e.config.slotId||!e.config.slotConfig)throw new Error("slot id and/or slot config is missing");e.maxAdReloads=-1===e.config.adReloaderDelay?1:e.config.maxAdReloads||10,e.deferUntilEvent||e._load()}))}},{key:"attributeChangedCallback",value:function(e){if("auto-reload-paused"===e&&this.reloadTimer)if(this.isPaused)this.reloadTimer.pause(),this.prebidReloadTimer.pause(),clearInterval(this.s2RInterval);else if(this.reloadTimer.resume(),this.prebidReloadTimer.resume(),this.scrollToRefreshThreshold){var t=this._scrollToRefreshTickHandler.bind(this);this.s2RInterval=setInterval(t,500)}}},{key:"reload",value:function(e){var t=this._reloadCount,i=this.config.slotConfig;if(t<this.maxAdReloads&&!this.isPaused){if(this.hasChildNodes()){var n=this.handleAd,s=(new Date).getTime();this.prebidTime&&30<(s-this.prebidTime)/1e3&&(e=!1),window.phxAdvertisingQueue.push((function(){this.reloadAd(i,e).then((function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];e.map(n)}))}))}else this._addSlotDiv(),this._load();this.autoReload&&this._setLoadTimer(),this.config.slotConfig.model&&"number"==typeof this.config.slotConfig.model.index&&this.config.slotConfig.model.index++,this._reloadCount++,this._reloadCount>this.maxAdReloads&&this.cancelReloading()}}},{key:"_handleAd",value:function(e){var t=this.config.slotConfig,i=this.config.adReloaderSizeCodes||[];if(!e.filled)return this.isFilled=!1,void this._setLoadTimer();var n=e.sizeDims,s=!1;if(window.pbjs){var o=window.pbjs.getAdserverTargetingForAdUnitCode(this.config.slotId)||{};-1<p.indexOf(o.hb_bidder)&&(s=o.hb_deal)}if(this.skipScrollToRefresh=!1,-1<i.indexOf(n)){if(t.screenSizes&&1===t.screenSizes.length&&"A"===t.screenSizes[0]&&t.model&&"fixed_bottom"===t.model.zone)if("1x1"===n)this.reloadDelay=20;else{var a=e.responseInfo&&e.responseInfo.dfp&&e.responseInfo.dfp.lineItemId;this.reloadDelay=a?20:30}s&&(this.reloadDelay=Math.max(this.reloadDelay,30),this.skipScrollToRefresh=!0)}else this.autoReload=!1;var r,l,d=[];t.config&&t.config.sizes&&t.config.sizes.length&&(l=[],(r=t.config.sizes).some(Array.isArray)?l=r.reduce((function(e,t){return e.push(Array.isArray(t)?t.join("x"):t),e}),[]):2!==r.length||r.some(isNaN)?l=r:l.push(r.join("x")),d=l),-1<d.concat(f,["1x1"]).indexOf(n)?this.config.slotId&&this.closeButton&&!this.closeButtonDiv&&this._addCloseButton(this.config.slotId):this.handleNonstandardSize(),this.isFilled=!0,"none"===this.style.display&&(this.style.display="",this.inView=!0),this.adLoadedTime=(new Date).getTime(),this.autoReload?!this.reloadTimer&&this._setLoadTimer():this.cancelReloading()}},{key:"cancelReloading",value:function(){this.reloadTimer&&this.reloadTimer.cancel(),this.prebidReloadTimer&&this.prebidReloadTimer.cancel(),clearInterval(this.s2RInterval)}},{key:"handleNonstandardSize",value:function(){this.closeButton&&(this.closeButtonDiv&&this.closeButtonDiv.parentElement.removeChild(this.closeButtonDiv),this.closeButton=!1,this.closeButtonDiv=void 0)}},{key:"_addCloseButton",value:function(e){var t=this;this.closeButtonDiv=document.createElement("div"),this.closeButtonDiv.classList.add("m-advertisement--close-button");var i=document.createElement("div");i.innerHTML="CLOSE",i.classList.add("m-advertisement--close-button-label"),this.closeButtonDiv.appendChild(i),this.closeButtonHandler=function(){return t.style.display="none",t._unload(),!1},this.closeButtonDiv.addEventListener("click",this.closeButtonHandler),document.getElementById(e).parentElement.appendChild(this.closeButtonDiv)}},{key:"_addSlotDiv",value:function(e){var t,i=document.createElement("div"),s=document.createElement("div"),o=this.config.visClasses||[];if(s.id=e,this.config.moduleClass&&o.push(this.config.moduleClass),o.push("is-placeholder"),(t=i.classList).add.apply(t,n(o)),this.containerClass){var a,r=this.containerClass.split(" ");(a=i.classList).add.apply(a,n(r))}this.containerHeight&&(i.style.height=this.containerHeight+"px"),this.containerWidth&&(i.style.width=this.containerWidth+"px"),i.appendChild(s),this.appendChild(i)}},{key:"_scrollToRefreshTickHandler",value:function(){var t=this;if(!this.isHidden&&this.adLoadedTime&&(new Date).getTime()-this.adLoadedTime>4e3){var i=this.config.slotConfig,n=568>window.innerHeight?568:window.innerHeight,s=(window.pageYOffset-this.lastPageYOffset)/n;if(Math.abs(s)>=this.scrollToRefreshThreshold){clearInterval(this.s2RInterval);var o=this.reloadTimer;if(o&&!o.cancelled&&o.remaining()<2e3)this.lastPageYOffset=window.pageYOffset;else{this.cancelReloading();var a="s2r-"+i.id+"-"+this._reloadCount;this.adAuctionPromise.then((function(e){e.rerunAuction(i.id,2e3,a)})).catch((function(e){console.warn("Scroll to refresh auction failed: "+e)})),this.reloadTimer=new e((function(){t.reload(a)}),2010),this.lastPageYOffset=window.pageYOffset}}}}},{key:"_load",value:function(){var e=this.config.slotConfig,t=this.handleAd;window.phxAdvertisingQueue.push((function(){this.getSlotResult(e.id).then(t)})),this.skipDynamicCall||window.phxAdvertisingQueue.push((function(){this.dynamicCall({slots:[e]})})),this.autoReload&&(this.reloadDelay=parseInt(this.config.adReloaderDelay,10)||30,this.inView=!this.trackVisibility,this.trackVisibility&&this.observeVisibilityChanges())}},{key:"onChangeToVisible",value:function(){this.inView=!0,this.isPaused=!1,this.isFilled&&(this.adLoadedTime=(new Date).getTime())}},{key:"onChangeToNotVisible",value:function(){this.inView=!1,this.isPaused=!0}},{key:"_initListeners",value:function(){this.callbacks=this._bindCallbacks(),window.addEventListener("message",this.callbacks.takeover,!1),document.addEventListener("visibilitychange",this.callbacks.browserTabVisibility),document.addEventListener("phxCollection:enterFullscreen",this.callbacks.galleryOpened),document.addEventListener("phxCollection:exitFullscreen",this.callbacks.galleryClosed),this.fixedVisible&&(document.addEventListener("salishRecirculation:opened",this.callbacks.salishRecirculationOpened),document.addEventListener("salishRecirculation:closed",this.callbacks.salishRecirculationClosed))}},{key:"_setLoadTimer",value:function(){var t=this,i=this.adAuctionPromise,n=this.config.slotConfig;if(n&&n.id){if(this.cancelReloading(),this.autoReload&&!(0>=this.reloadDelay)){var s=n.id+"-"+this._reloadCount,o=Math.max(this.reloadDelay-30,0),a=Math.max(this.reloadDelay-o-3,2);if(this.prebidReloadTimer=new e((function(){t._reloadCount<=t.maxAdReloads&&!t.isHidden&&i.then((function(e){e.rerunAuction(n.id,1e3*a,s),t.prebidTime=(new Date).getTime()})).catch((function(e){console.warn("Prebid auction failed: "+e)}))}),1e3*o),this.reloadTimer=new e((function(){t._reloadCount<=t.maxAdReloads&&!t.isHidden&&t.reload(s)}),1e3*this.reloadDelay),this.scrollToRefreshThreshold&&!this.skipScrollToRefresh){var r=this._scrollToRefreshTickHandler.bind(this);this.lastPageYOffset=window.pageYOffset,this.s2RInterval=setInterval(r,500)}}}else console.warn("Malformed ad slot config missing id; reload timer cancelled.")}},{key:"_bindCallbacks",value:function(){return{browserTabVisibility:this._browserTabVisibilityCallback.bind(this),galleryClosed:this._galleryClosed.bind(this),galleryOpened:this._galleryOpened.bind(this),salishRecirculationOpened:this._salishRecirculationOpened.bind(this),salishRecirculationClosed:this._salishRecirculationClosed.bind(this),takeover:this._takeoverCallback.bind(this)}}},{key:"_takeoverCallback",value:function(e){if(e.origin.match(window.location.host))try{var t=JSON.parse(e.data);"takeoveropened"===t.event?this.isPaused=!0:"takeoverclosed"===t.event&&this.inView&&(this.isPaused=!1)}catch(e){}}},{key:"_galleryOpened",value:function(){this.isPaused=!0}},{key:"_galleryClosed",value:function(){this.inView&&(this.isPaused=!1)}},{key:"smallScreen",get:function(){var e="A"===this.breakpoint?600:1e3;return window.innerHeight<e}},{key:"_salishRecirculationOpened",value:function(){var e=this,t=(new Date).getTime(),i=Math.max(5e3-(t-this.adLoadedTime),0);window.setTimeout((function(){e.style.display="none",e.inView=!1,e.isPaused=!0}),i)}},{key:"_salishRecirculationClosed",value:function(){this.isPaused=!1,this.isFilled&&(this.style.display="",this.inView=!0,this.adLoadedTime=(new Date).getTime())}},{key:"_browserTabVisibilityCallback",value:function(){this.inView&&(this.isPaused="hidden"===document.visibilityState)}},{key:"_unload",value:function(){if(!this.unloaded){this.cancelReloading(),this.trackVisibility&&this.unobserveVisibilityChanges(),this.closeButtonDiv&&this.closeButtonDiv.removeEventListener("click",this.closeButtonHandler);var e=this.config.slotId;window.phxAdvertisingQueue.push((function(){this.resetAdSlot(e)})),this.autoReload&&this.callbacks&&(window.removeEventListener("message",this.callbacks.takeover),document.removeEventListener("visibilitychange",this.callbacks.browserTabVisibility),document.removeEventListener("phxCollection:enterFullscreen",this.callbacks.galleryOpened),document.removeEventListener("phxCollection:exitFullscreen",this.callbacks.galleryClosed),this.fixedVisible&&(document.removeEventListener("salishRecirculation:opened",this.callbacks.salishRecirculationOpened),document.removeEventListener("salishRecirculation:closed",this.callbacks.salishRecirculationClosed))),this.unloaded=!0}}},{key:"disconnectedCallback",value:function(){r(h(s.prototype),"disconnectedCallback",this).call(this),this._unload()}}])&&a(c.prototype,v),g&&a(c,g),s}(t.PhoenixElement);window.customElements.define("phoenix-ad",i)}))})()})();
//# sourceMappingURL=ad.min.js.map